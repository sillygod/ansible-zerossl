[pytest]
# Pytest configuration for Ansible ZeroSSL Plugin
minversion = 7.0
addopts =
    -ra
    -q
    --strict-markers
    --strict-config
    --tb=short
    --maxfail=5
    -p no:warnings

testpaths =
    tests

# Test markers for categorization
markers =
    unit: Unit tests for individual components with mocked dependencies
    component: Component tests for workflow integration with mocked external APIs
    integration: Real integration tests with external APIs (requires environment setup)
    live: Live tests requiring real API keys and network access
    contract: Contract tests for API compliance
    slow: Tests that take longer than 30 seconds
    network: Tests requiring internet/network access
    requires_api_key: Tests requiring valid ZeroSSL API key
    requires_domain: Tests requiring domain control

# Python paths for module discovery
pythonpath = . plugins

# Ignore patterns
norecursedirs =
    .git
    .tox
    dist
    build
    *.egg
    __pycache__

# Test collection patterns
python_files =
    test_*.py
    *_test.py

python_classes =
    Test*

python_functions =
    test_*

# Filterwarnings
filterwarnings =
    error
    ignore::UserWarning
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    # Ansible-specific warnings to ignore
    ignore:.*ansible\.module_utils\.basic.*:DeprecationWarning
    ignore:.*ansible\.plugins\.action.*:DeprecationWarning

# Coverage settings are now included in main addopts above

# Ansible-specific test environment variables
# Note: These should be set in CI/CD or manually as pytest doesn't support env config
# ANSIBLE_HOST_KEY_CHECKING = False
# ANSIBLE_RETRY_FILES_ENABLED = False
# ANSIBLE_PIPELINING = True
# ANSIBLE_GATHERING = explicit
